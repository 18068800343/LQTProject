<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<link rel="stylesheet" href="../../font2/iconfont.css">
	<link href="../../style/bootstrap.min.css" rel="stylesheet">
	<link href="../../style/style.css" rel="stylesheet">
	<link rel="stylesheet" href="../../style/jquery.dataTables.min.css">
	<link rel="stylesheet" href="../../style/jquery-editable-select.css">
	<link rel="stylesheet" type="text/css" href="../../easyUI/themes/default/easyui.css"/>
	<link rel="stylesheet" type="text/css" href="../../easyUI/themes/icon.css"/>
	<link rel="stylesheet" type="text/css" href="../../easyUI/demo/demo.css"/>
	<link rel="stylesheet" type="text/css" href="../../css/layui.css"/>
	<link rel="stylesheet" type="text/css" href="../../css/layui.mobile.css"/>
	<link rel="stylesheet" type="text/css" href="../../css/laydate.css"/>
	<link rel="stylesheet" type="text/css" href="../../css/code.css"/>
	<link rel="stylesheet" type="text/css" href="../../../js/skin/default/layer.css"/>
	<link rel="stylesheet" type="text/css" href="../../css/laydate.css"/>
	<link href="../../toastr/toastr.css" rel="stylesheet">
	<!-- SmartAdmin Styles : Caution! DO NOT change the order -->
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/smartadmin-production-plugins.min.css">
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/smartadmin-production.min.css">
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/smartadmin-skins.min.css">
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/font.css">
	<!-- SmartAdmin RTL Support  -->
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/smartadmin-rtl.min.css">
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/all.css">
	<style lang="">
		body {
			background: #fff;
		}

		.UpperPart {
			display: flex;
			justify-content: space-between;
			border-bottom: 1px solid #ccc;
			padding-bottom: 12px;
		}

		.selected {
			background: rgba(247, 161, 3, 0.2);
		}

		#mainContent th {
			cursor: pointer;
		}
	</style>
</head>
<body>

<!-- 面包屑 -->
<div class="mianbao">
	<ul class="breadcrumb">
		<li>
			<i class="iconfont icon-knowledgebase"></i>
		</li>
		<li>沥青生产监控管理</li>
		<li class="active">生产计划管理</li>
	</ul>
</div>
<div class="background" style="background-color:#F0F1F1;width:100%;height:40px;">
</div>
<div>
	<!-- Nav tabs -->
	<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
		<ul class="layui-tab-title" role="tablist" style="background: #fff;">
			<li role="presentation" class="active  layui-this">
				<a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">生产计划</a>
			</li>
			<li role="presentation">
				<a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">施工路段偏差</a>
			</li>
		</ul>
	</div>
	<!-- Tab panes -->
	<div class="tab-content">

		<div role="tabpanel" class="tab-pane active" id="profile">
			<div class="zhuti-content">
				<div class="UpperPart">
					<div class="UpperPartL">
						<button type="button" class="btn btn-primary Pbea" data-toggle="modal" data-target="#myModal2"
								style="margin: 5PX; float: left;">录入生产计划
						</button>
					</div>
					<div class="UpperPartR">
						<!--<button type="button" class="btn btn-primary" style="margin: 5PX;">导出Excel文件</button>-->
					</div>
				</div>
				<div class="LowerPart" style="margin-top: 3px;" name="tbVm">
					<div>
						<table  class="layui-table" lay-skin="line" id="mainContent" style="white-space: nowrap;">
							<thead>
							<tr style="background-color:#EBF4FF;border-bottom:none;background-image:none;">
								<th>生产计划编号</th>
								<th>路段编号</th>
								<th>路段名称</th>
								<th>混合料编号</th>
								<th>成品需要量（每日）</th>
								<th>待生产量</th>
								<th>完成时间</th>
								<th>干拌时间</th>
								<th>湿拌时间</th>
								<th>油石比</th>
								<th>成品温度要求</th>
								<th>到现场温度要求</th>
								<th>总价</th>
								<th>日期时间</th>
								<th>录入人</th>
								<th>状态</th>
								<th>操作</th>
							</tr>
							</thead>
							<tbody>
							<!--<tr>
                <td>
                    <i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息"  data-toggle="modal" data-target="#allMsg2"></i>
                    <i class="iconfont icon-xiugai" style="font-size:18px;cursor:pointer;" title="修改" data-toggle='modal' data-target='#change2'></i>
                    <i class="iconfont icon-shanchu" style="font-size:18px;cursor:pointer;" title="删除"></i>
                </td>
            </tr> -->
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>

		<div role="tabpanel" class="tab-pane" id="messages">
			<div class="zhuti-content">
				<div class="UpperPart">
					<div class="UpperPartL">
						<button type="button" class="btn btn-primary Pbee" data-toggle="modal" data-target="#myModal3" style="margin: 5PX; float: left;">录入施工路段偏差</button>
					</div>
					<div class="UpperPartR">
						<!--<button type="button" class="btn btn-primary" style="margin: 5PX;">导出Excel文件</button>-->
					</div>
				</div>
				<div class="LowerPart" style="margin-top: 3px;">
					<table table class="layui-table "lay-skin="line" id="mainContent2" style="white-space: nowrap;">
						<thead>
						<tr style="background-color:#EBF4FF;border-bottom:none;background-image:none;">
							<th>偏差编号</th>
							<th>偏差名称</th>
							<td>0-3偏差量</td>
							<th>3-6偏差量</th>
							<td>6-11偏差量</td>
							<td>11-17偏差量</td>
							<td>17-22偏差量</td>
							<td>22-32偏差量</td>
							<th>粉偏差量</th>
							<th>沥青偏差量</th>
							<th>成品温度偏差量</th>
							<th>到场温度偏差量</th>
							<th>干拌用时偏差量</th>
							<th>湿拌用时偏差量</th>
							<th>4.75偏差量</th>
							<th>2.36偏差量</th>
							<th>0.075偏差量</th>
							<th style="width: 75px;">操作</th>
						</tr>
						</thead>
						<tbody>

						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg3">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>所有信息</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="table table-bordered table-condensed" style="height: 400PX;">
							<tr>
								<td style="width: 20%;">序号</td>
								<td>1</td>
							</tr>
							<tr>
								<td>路段</td>
								<td>1</td>
							</tr>
							<tr>
								<td>成品差</td>
								<td>1</td>
							</tr>
							<tr>
								<td>0-3用量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>3-6用量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>6-11用量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>11-17用量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>17-22用量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>22-32用量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>粉料偏差量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>沥青偏差量</td>
								<td>1</td>
							</tr>
							<tr>
								<td>干拌时间</td>
								<td>2019-10-10 12:00:00</td>
							</tr>
							<tr>
								<td>油石比</td>
								<td>1</td>
							</tr>
							<tr>
								<td>湿拌时间</td>
								<td>2019-10-10 12:00:00</td>
							</tr>
							<tr>
								<td>级配</td>
								<td>1</td>
							</tr>
						</table>

					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>
<!-- allMsg结束 -->
<!-- 修改Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="change">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>修改配方信息</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="table table-bordered table-condensed" style="height: 400PX;">
							<tr>
								<td style="width: 20%;">序号</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>配方名称</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>0-3用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>3-6用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>6-11用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>11-17用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>17-22用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>22-32用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>粉料用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>沥青用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>添加剂材料</td>
								<td><select name="" style="width: 100%; height: 100%; border: none;">
									<option value="">请选择</option>
									<option value="">木质纤维</option>
									<option value="">玄武岩纤维</option>
									<option value="">抗车辙剂</option>
									<option value="">聚酯纤维</option>
									<option value="">高粘剂</option>
									<option value="">相变材料</option>
									<option value="">复合高模量剂</option>
								</select></td>
							</tr>
						</table>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-success">保存</button>
			</div>
		</div>
	</div>
</div>
<!-- 修改model结束 -->
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>录入配方信息</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="table table-bordered table-condensed" style="height: 400PX;">
							<tr>
								<td style="width: 20%;">序号</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>配方名称</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>0-3用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>3-6用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>6-11用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>11-17用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>17-22用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>22-32用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>粉料用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>沥青用量</td>
								<td><input type="text" id="" placeholder="请输入" style="width: 100%; height: 100%; border: none;"></td>
							</tr>
							<tr>
								<td>添加剂材料</td>
								<td><select name="" style="width: 100%; height: 100%; border: none;">
									<option value="">请选择</option>
									<option value="">木质纤维</option>
									<option value="">玄武岩纤维</option>
									<option value="">抗车辙剂</option>
									<option value="">聚酯纤维</option>
									<option value="">高粘剂</option>
									<option value="">相变材料</option>
									<option value="">复合高模量剂</option>
								</select></td>
							</tr>
						</table>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-default">保存</button>
			</div>
		</div>
	</div>
</div>
<!-- model结束 -->
<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg">
	<div class="modal-dialog modal-lg" role="document" >
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>关联偏差</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<div class="input-group" id="glpianchaVm">
							<span class="input-group-addon">关联偏差:</span>
							<input type="text" class="form-control" v-model="pianchaname" placeholder="" >
						</div>

						<table class="table table-bordered" id="mainContent3" style="width:100%;white-space: nowrap;">
							<thead>
							<tr>
								<th style="width: 75px;">操作</th>
								<th>偏差编号</th>
								<th>偏差名称</th>
								<td>0-3偏差量</td>
								<th>3-6偏差量</th>
								<td>6-11偏差量</td>
								<td>11-17偏差量</td>
								<td>17-22偏差量</td>
								<td>22-32偏差量</td>
								<th>粉偏差量</th>
								<th>沥青偏差量</th>
								<th>最高温度偏差量</th>
								<th>最低温度偏差量</th>
								<th>干拌用时偏差量</th>
								<th>湿拌用时偏差量</th>
								<th>4.75偏差量</th>
								<th>2.36偏差量</th>
								<th>0.075偏差量</th>
							</tr>
							</thead>
							<tbody>

							</tbody>
						</table>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>
<!-- allMsg结束 -->
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal2">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content" id="NewShengChanJiHua">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>录入生产计划数据</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="layui-table "lay-skin="line" style="height:auto;" >
							<!--							<tr>-->
							<!--								<td>生产计划编号</td>-->
							<!--								<td><input class="form-control" type="text" v-model="planno" id="planno"-->
							<!--										   placeholder="请输入" style="width: 100%; height: 100%; "></td>-->
							<!--								<td></td>-->
							<!--								<td></td>-->
							<!--							</tr>-->
							<tr>
								<td>混合料名称</td>
								<td><select class="form-control" style="width: 100%;"
											v-model="recipeid = recipeSelected" id="recipeid">
									<option :value="item.flId" v-for="item in recipeList">{{item.flName}}</option>
								</select></td>
								<td>成品需要量</td>
								<td><input class="form-control" type="text" @blur="reg(pdneed,'xiaoshu','pdneed')"
										   v-model="pdneed" id="pdneed" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>要求完成时间</td>
								<td><input class="form-control" type="text" readonly="true" v-model="finishTime"
										   id="finishTime" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>
									路名
									<!--									干拌时间-->
								</td>
								<td>
									<input class="form-control" type="text" v-model="roadName" id="roadName"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; ">
									<!--									<input class="form-control" type="text" readonly="true" v-model="drymixingtime"-->
									<!--										   id="drymixingtime" placeholder="请输入"-->
									<!--										   style="width: 100%; height: 100%; ">-->
								</td>
							</tr>
							<!--							<tr hidden>-->
							<!--								<td hidden>湿拌时间</td>-->
							<!--								<td hidden><input class="form-control" type="text" readonly="true" v-model="wetmixingtime"-->
							<!--										   id="wetmixingtime" placeholder="请输入"-->
							<!--										   style="width: 100%; height: 100%;"></td>-->
							<!--								<td hidden>油石比</td>-->
							<!--								<td hidden><input class="form-control" type="text" @blur="reg(radio,'xiaoshu','radio')"-->
							<!--										   v-model="radio" id="radio" placeholder="请输入" value="00:00:00"-->
							<!--										   style="width: 100%; height: 100%; "></td>-->
							<!--							</tr>-->
							<tr>
								<td>成品温度要求</td>
								<td><input class="form-control" type="text" @blur="reg(pdtemp,'xiaoshu','pdtemp')"
										   v-model="pdtemp" id="pdtemp" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>
									<!--									到现场温度要求-->
								</td>
								<td>
									<!--									<input class="form-control" type="text"-->
									<!--										   @blur="reg(arrivetemp,'xiaoshu','arrivetemp')" v-model="arrivetemp"-->
									<!--										   id="arrivetemp" placeholder="请输入"-->
									<!--										   style="width: 100%; height: 100%; ">-->
								</td>
							</tr>
							<tr>
								<td>单价</td>
								<td><input class="form-control" type="text" @blur="reg(price,'xiaoshu','price')"
										   v-model="price" id="price" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>规划高速路径</td>
								<td><input class="form-control" type="text" v-model="pathPlan" id="pathPlan"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>运输距离</td>
								<td><input class="form-control" type="text" @blur="reg(distance,'xiaoshu','distance')"
										   v-model="distance" id="distance" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>路段经度</td>
								<td><input class="form-control" type="text" @blur="reg(lng,'price','lng')"
										   v-model="lng" id="lng" placeholder="请输入"
										   style="width: 100%; height: 100%; " disabled></td>
								<td>路段纬度</td>
								<td><input class="form-control" type="text" @blur="reg(lat,'xiaoshu','lat')"
										   v-model="lat" id="lat" placeholder="请输入"
										   style="width: 100%; height: 100%; " disabled></td>
							</tr>
							<tr>
								<td>施工桩号</td>
								<td><input class="form-control" type="text" v-model="stakeMark" id="stakeMark"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>桩号米数</td>
								<td><input class="form-control" type="text" v-model="turnRoundStakeMark"
										   id="turnRoundStakeMark" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>路面施工队</td>
								<td><input class="form-control" type="text" v-model="team" id="team" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>方向</td>
								<td><input class="form-control" type="text" v-model="direction" id="direction"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>

							<tr>
								<td>施工层</td>
								<td><select class="form-control" style="width: 100%;" v-model="shigongceng">
									<option value="上">上</option>
									<option value="中">中</option>
									<option value="下">下</option>
								</select></td>
								<td>施工车道</td>
								<td><input class="form-control" type="text" v-model="chedao" id="chedao"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
						</table>
                        <div style="width: 870px;height: 300px;" id="map"></div>
                    </form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>

				<button type="button" class="btn btn-default" v-on:click="save" id="saveShengChanJiHua">保存</button>
			</div>
		</div>
	</div>
</div>
<!-- model结束 -->
<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg2">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content" id="linkPianChaDetailVm">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>所有信息</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="table table-bordered table-condensed" style="height: auto;">
							<tr>
								<td style="width: 20%;">偏差编号</td>
								<td>{{pianchano}}</td>
								<td>偏差名称</td>
								<td>{{pianchaname}}</td>
							</tr>
							<tr>
								<td>0-3用量</td>
								<td>{{Materialdeviation1}}</td>
								<td>3-6用量</td>
								<td>{{Materialdeviation2}}</td>
							</tr>
							<tr>
								<td>6-11用量</td>
								<td>{{Materialdeviation3}}</td>
								<td>11-17用量</td>
								<td>{{Materialdeviation4}}</td>
							</tr>
							<tr>
								<td>17-22用量</td>
								<td>{{Materialdeviation5}}</td>
								<td>22-32用量</td>
								<td>{{Materialdeviation6}}</td>
							</tr>
							<tr>
								<td>粉料偏差量</td>
								<td>{{Boneflourdeviation}}</td>
								<td>沥青偏差量</td>
								<td>{{pitchdeviation}}</td>
							</tr>
							<tr>
							</tr>
							<tr>
								<td>最高温度</td>
								<td>{{pdTempOffset}}</td>
								<td>最低温度</td>
								<td>{{arriveTempOffset}}</td>
							</tr>
							<tr>
								<td>干拌时间偏差</td>
								<td>{{drymixingtimedeviation}}</td>
								<td>湿拌时间偏差</td>
								<td>{{wetmixingtimedeviation}}</td>
							</tr>
							<tr>
								<td>通过率偏差4.75</td>
								<td>{{pass475}}</td>
								<td>通过率偏差2.36</td>
								<td>{{pass236}}</td>
							</tr>
							<tr>
								<td>通过率偏差0.075</td>
								<td>{{pass0075}}</td>
								<td></td>
								<td></td>
							</tr>
						</table>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>
<!-- allMsg结束 -->
<!-- 修改Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="change2">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>修改生产数据计划</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="table table-bordered table-condensed" style="height: auto;">
							<tr>
								<td>生产计划编号</td>
								<td><input class="form-control" type="text" v-model="planno" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>路名</td>
								<td><input class="form-control" type="text" v-model="roadName"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>混合料名称</td>
								<td><select class="form-control" style="width: 100%;"
											v-model="recipeid = recipeSelected">
									<option :value="item.flId" v-for="item in recipeList">{{item.flName}}</option>
								</select></td>
								<td>成品需要量</td>
								<td><input class="form-control" type="text" @blur="reg(pdneed,'xiaoshu','pdneed')"
										   v-model="pdneed" placeholder="请输入" style="width: 100%; height: 100%;"/></td>

							</tr>
							<tr>
								<td>要求完成时间</td>
								<td><input class="form-control" type="text" readonly="true" v-model="finishTime" id="xgfinishTime"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td hidden>干拌时间</td>
								<td hidden><input class="form-control" type="text" readonly="true" v-model="drymixingtime"
										   placeholder="请输入" id="xgdrymixingtime"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td hidden>湿拌时间</td>
								<td hidden><input class="form-control" type="text" readonly="true" v-model="wetmixingtime"
										   placeholder="请输入" id="xgwetmixingtime"
										   style="width: 100%; height: 100%;"></td>
								<td hidden>油石比</td>
								<td hidden><input class="form-control" type="text" @blur="reg(radio,'xiaoshu','radio')" v-model="radio" placeholder="请输入" style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>成品温度要求</td>
								<td><input class="form-control" type="text" @blur="reg(pdtemp,'xiaoshu','pdtemp')" v-model="pdtemp" placeholder="请输入" style="width: 100%; height: 100%;"></td>
								<td hidden>到现场温度要求</td>
								<td hidden><input class="form-control" type="text"
										   @blur="reg(arrivetemp,'xiaoshu','arrivetemp')" v-model="arrivetemp"
										   placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>单价</td>
								<td><input class="form-control" type="text" @blur="reg(price,'xiaoshu','price')"
										   v-model="price" placeholder="请输入" style="width: 100%; height: 100%;"></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>规划高速路径</td>
								<td><input class="form-control" type="text" v-model="pathPlan"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>运输距离</td>
								<td><input class="form-control" type="text" @blur="reg(distance,'xiaoshu','distance')"
										   v-model="distance" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>路段经度</td>
								<td><input class="form-control" type="text" @blur="reg(lng,'price','lng')"
										   v-model="lng" placeholder="请输入"
										   style="width: 100%; height: 100%; " disabled></td>
								<td>路段纬度</td>
								<td><input class="form-control" type="text" @blur="reg(lat,'xiaoshu','lat')"
										   v-model="lat" placeholder="请输入"
										   style="width: 100%; height: 100%; " disabled></td>
							</tr>
							<tr>
								<td>施工桩号</td>
								<td><input class="form-control" type="text" v-model="stakeMark"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>桩号米数</td>
								<td><input class="form-control" type="text" v-model="turnRoundStakeMark"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>路面施工队</td>
								<td><input class="form-control" type="text" v-model="team" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>方向</td>
								<td><input class="form-control" type="text" v-model="direction"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>施工层</td>
								<td><select class="form-control" style="width: 100%;" v-model="shigongceng">
									<option value="上">上</option>
									<option value="中">中</option>
									<option value="下">下</option>
								</select></td>
								<td>施工车道</td>
								<td><input class="form-control" type="text" v-model="chedao"
										   placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
						</table>
						<div style="width: 870px;height: 300px;" id="xgmap"></div>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-success" @click="save">保存</button>
			</div>
		</div>
	</div>
</div>
<!-- 修改model结束 -->

<!-- 录入施工路段偏差-->
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal3">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content" id="addSGPC">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>录入施工路段偏差</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="layui-table "lay-skin="line" style="height:auto;" >
							<tr>
								<td style="width: 20%;">偏差编号</td>
								<td><input class="form-control" type="text" v-model="pianchano" placeholder="请输入" style="width: 100%; height: 100%;"></td>
								<td>偏差名称</td>
								<td><input class="form-control" type="text" v-model="pianchaname" id="" placeholder="请输入" style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>0-3用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation1,'xiaoshu','Materialdeviation1')" v-model="Materialdeviation1" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>3-6用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation2,'xiaoshu','Materialdeviation2')" v-model="Materialdeviation2" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>6-11用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation3,'xiaoshu','Materialdeviation3')" v-model="Materialdeviation3" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>11-17用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation4,'xiaoshu','Materialdeviation4')" v-model="Materialdeviation4" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>17-22用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation5,'xiaoshu','Materialdeviation5')" v-model="Materialdeviation5" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>22-32用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation6,'xiaoshu','Materialdeviation6')" v-model="Materialdeviation6" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>粉料偏差量</td>
								<td><input class="form-control" type="text" @blur="reg(Boneflourdeviation,'xiaoshu','Boneflourdeviation')" v-model="Boneflourdeviation" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>沥青偏差量</td>
								<td><input class="form-control" type="text" @blur="reg(pitchdeviation,'xiaoshu','pitchdeviation')" v-model="pitchdeviation" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
							</tr>
							<tr>
								<td>最高温度</td>
								<td><input class="form-control" type="text" @blur="reg(pdTempOffset,'xiaoshu','pdTempOffset')" v-model="pdTempOffset" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>最低温度</td>
								<td><input class="form-control" type="text" @blur="reg(arriveTempOffset,'xiaoshu','arriveTempOffset')" v-model="arriveTempOffset" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>干拌时间偏差</td>
								<td><input class="form-control" type="text" @blur="reg(drymixingtimedeviation,'xiaoshu','drymixingtimedeviation')" v-model="drymixingtimedeviation"
										   id="drymixingtimedeviation" placeholder="请输入" style="width: 100%; height: 100%; "></td>
								<td>湿拌时间偏差</td>
								<td><input class="form-control" type="text" @blur="reg(wetmixingtimedeviation,'xiaoshu','wetmixingtimedeviation')" v-model="wetmixingtimedeviation"
										   id="wetmixingtimedeviation" placeholder="请输入" style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>通过率偏差4.75</td>
								<td><input class="form-control" type="text" @blur="reg(pass475,'xiaoshu','pass475')" v-model="pass475" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>通过率偏差2.36</td>
								<td><input class="form-control" type="text" @blur="reg(pass236,'xiaoshu','pass236')" v-model="pass236" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>通过率偏差0.075</td>
								<td><input class="form-control" type="text" @blur="reg(pass0075,'xiaoshu','pass0075')" v-model="pass0075" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td></td>
								<td></td>
							</tr>
						</table>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-default" @click="save">保存</button>
			</div>
		</div>
	</div>
</div>
<!-- model结束 -->

<!-- 修改施工路段偏差-->
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="change3">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content" id="xgSGPC">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">
					<b>修改施工路段偏差</b>
				</h4>
			</div>
			<div class="modal-body">
				<div>
					<form class="form-inline">
						<table class="layui-table "lay-skin="line" style="height:auto;" >
							<tr>
								<td style="width: 20%;">偏差编号</td>
								<td><input class="form-control" type="text" v-model="pianchano" placeholder="请输入" style="width: 100%; height: 100%; "></td>
								<td>偏差名称</td>
								<td><input class="form-control" type="text" v-model="pianchaname" id="" placeholder="请输入" style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>0-3用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation1,'xiaoshu','Materialdeviation1')" v-model="Materialdeviation1" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>3-6用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation2,'xiaoshu','Materialdeviation2')" v-model="Materialdeviation2" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>6-11用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation3,'xiaoshu','Materialdeviation3')" v-model="Materialdeviation3" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>11-17用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation4,'xiaoshu','Materialdeviation4')" v-model="Materialdeviation4" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>17-22用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation5,'xiaoshu','Materialdeviation5')" v-model="Materialdeviation5" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>22-32用量</td>
								<td><input class="form-control" type="text" @blur="reg(Materialdeviation6,'xiaoshu','Materialdeviation6')" v-model="Materialdeviation6" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
							</tr>
							<tr>
								<td>粉料偏差量</td>
								<td><input class="form-control" type="text" @blur="reg(Boneflourdeviation,'xiaoshu','Boneflourdeviation')" v-model="Boneflourdeviation" id="" placeholder="请输入"
										   style="width: 100%; height: 100%; "></td>
								<td>沥青偏差量</td>
								<td><input class="form-control" type="text" @blur="reg(pitchdeviation,'xiaoshu','pitchdeviation')" v-model="pitchdeviation" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>最高温度</td>
								<td><input class="form-control" type="text" @blur="reg(pdTempOffset,'xiaoshu','pdTempOffset')" v-model="pdTempOffset" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>最低温度</td>
								<td><input class="form-control" type="text" @blur="reg(arriveTempOffset,'xiaoshu','arriveTempOffset')" v-model="arriveTempOffset" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>干拌时间偏差</td>
								<td><input class="form-control" type="text" @blur="reg(drymixingtimedeviation,'xiaoshu','drymixingtimedeviation')" v-model="drymixingtimedeviation"
										   id="xgdrymixingtimedeviation" placeholder="请输入" style="width: 100%; height: 100%;"></td>
								<td>湿拌时间偏差</td>
								<td><input class="form-control" type="text" @blur="reg(wetmixingtimedeviation,'xiaoshu','wetmixingtimedeviation')" v-model="wetmixingtimedeviation"
										   id="xgwetmixingtimedeviation" placeholder="请输入" style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>通过率偏差4.75</td>
								<td><input class="form-control" type="text" @blur="reg(pass475,'xiaoshu','pass475')" v-model="pass475" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td>通过率偏差2.36</td>
								<td><input class="form-control" type="text" @blur="reg(pass236,'xiaoshu','pass236')" v-model="pass236" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
							</tr>
							<tr>
								<td>通过率偏差0.075</td>
								<td><input class="form-control" type="text" @blur="reg(pass0075,'xiaoshu','pass0075')" v-model="pass0075" id="" placeholder="请输入"
										   style="width: 100%; height: 100%;"></td>
								<td></td>
								<td></td>
							</tr>
						</table>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" @click="save" class="btn btn-default">保存</button>
			</div>
		</div>
	</div>
</div>
<!-- model结束 -->
</body>
<script src="../../js/jquery.js"></script>
<script src="../../js/common-scripts.js"></script>
<script src="../../toastr/toastr.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/jquery.dataTables.min.js"></script>
<script src="../../js/jquery-editable-select.js"></script>
<script src="../../easyUI/jquery.easyui.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js"></script>
<script src="../../js/laydate/laydate.js"></script>
<script src="../../js/layui.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/element.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/echarts.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.staticfile.org/vue-resource/1.5.1/vue-resource.min.js"></script>
<script src="../../js/quanxian.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=BmTwezCvWyGaH3KNYkc5P6uq"></script>
<script>
	$(document).ready( function () {
		$("#channeng").trigger("change");
		initTable();
		initTablePianCha();
	});

	var table=$('#mainContent').DataTable({
		"deferRender": true,
		"processing": true,
		"bDestroy": true,
		"iDisplayLength": 10,
		"searching": true,
		"lengthChange": false,
		"oLanguage": {
			"sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		/*"pagingType": "full_numbers",*/
		"order": [],
		"columns": [
			{"data": "planno"},
			{"data": "roadno", visible: false},
			{"data": "roadname"},
			{"data": "flno"},
			{"data": "pdneed"},
			{"data": "sumneed"},
			{"data": "finishTime"},
			{"data": "drymixingtime"},
			{"data": "wetmixingtime"},
			{"data": "radio"},
			{"data": "pdtemp"},
			{"data": "arrivetemp"},
			{ "data": "zongjia"},
			{ "data": "datetime"},
			{ "data": "uname"},
			{ "data": "planstatecn"},
			{ "data": "planid"},
		],
		"columnDefs": [
			{
				"class": "tcenter",
				"targets": 16,
				"searchable": true,
				"render": function(data, type, full) {
					var guanlian= '<i class="glyphicon glyphicon-random Pbed" style="font-size:13px;cursor:pointer;margin-right:3px;display:none;" onclick="linkMsg(this)" title="关联偏差"   data-toggle="modal" data-target="#allMsg"></i>'
					var xiangqing= '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看偏差信息" data-id="'+full.pianchaid+'" onclick="lookPianChaMsg(this)"   data-toggle="modal" data-target="#allMsg2"></i>'
					var xiugai='<i class="iconfont icon-xiugai Pbeb" style="font-size:18px;cursor:pointer;display:none;" data-f="'+full+'"   onclick="udMsg(this)" title="修改" data-toggle="modal" data-target="#change2"></i>'

					var qiyong='<i class="iconfont icon-shanchu Pbec " style="font-size:18px;cursor:pointer;display:none;" data-id="'+data+'" onclick="delMsg(this)" title="删除"></i>'
					if(isNull(full.pianchaid)){
						return xiugai+qiyong;
					}else{
						return xiangqing+xiugai+qiyong;
					}
				}
			},
			{
				"class": "tcenter",
				"targets": 6,
				"searchable": true,
				"createdCell": function(td,data, full) {
					/*console.log(arr)
					console.log(colorArr)*/
					if(arr!=null&&arr.length!=0){
						for(var i=0;i<arr.length;i++){
							if(arr[i].indexOf(full.planno) >= 0 ) {
								//var index=$.inArray(arr[i], arr);
								$(td).css("background-color",colorArr[i])
							}
						}
					}

					return data;
				}
			}
		],
		"fnDrawCallback" : function() {
			initTableQuanxian()
		},
		//让表格出横向滚动条 ，此时 表头和 表中数据将分为两个部分
		"sScrollX":true,
		// 让表格的宽度不自适应 ，固定宽度。 如果不设置 表头和表中数据会分离
		//表中的数据自适应 ，表头的宽度固定
		"bAutoWidth":false,
		"oLanguage": { //国际化配置
			"sProcessing": "正在获取数据，请稍后...",
			"sLengthMenu": "显示 _MENU_ 条",
			"sZeroRecords": "查询不到相关数据",
			"sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
			"sInfoEmpty": "记录数为0",
			"sInfoFiltered": "(全部记录数 _MAX_ 条)",
			"sInfoPostFix": "",
			"sSearch": "搜索",
			"sUrl": "",
			"oPaginate": {
				"sFirst": "第一页",
				"sPrevious": "上一页",
				"sNext": "下一页",
				"sLast": "最后一页"
			}},
	});
	var table2=$('#mainContent2').DataTable({
		"deferRender": true,
		"processing": true,
		"bDestroy": true,
		"iDisplayLength": 10,
		"searching": true,
		"lengthChange": false,
		"oLanguage": {
			"sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"order": [[0, 'asc']],
		"columns": [
			{ "data": "pianchano"},
			{ "data": "pianchaname"},
			{ "data": "Materialdeviation1"},
			{ "data": "Materialdeviation2"},
			{ "data": "Materialdeviation3"},
			{ "data": "Materialdeviation4"},
			{ "data": "Materialdeviation5"},
			{ "data": "Materialdeviation6"},
			{ "data": "Boneflourdeviation"},
			{ "data": "pitchdeviation"},
			{ "data": "pdTempOffset"},
			{ "data": "arriveTempOffset"},
			{ "data": "drymixingtimedeviation"},
			{ "data": "wetmixingtimedeviation"},
			{ "data": "pass475"},
			{ "data": "pass236"},
			{ "data": "pass0075"},
			{ "data": "id"},
		],
		"columnDefs": [
			{
				"class": "tcenter",
				"targets": 17,
				"searchable": true,
				"render": function(data, type, full) {

					//var xiangqing= '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看偏差信息"   data-toggle="modal" data-target="#allMsg3"></i>'
					var xiugai='<i class="iconfont icon-xiugai Pbef" style="font-size:18px;cursor:pointer;display:none;" data-f="'+full+'"   onclick="pcMsg(this)" title="修改" data-toggle="modal" data-target="#change3"></i>'

					var qiyong='<i class="iconfont icon-shanchu Pbeg" style="font-size:18px;cursor:pointer;display:none;" data-id="'+data+'" onclick="delpiancha(this)" title="删除"></i>'

					return xiugai+qiyong;
				}
			}
		],
		"fnDrawCallback" : function() {
			initTableQuanxian()
		},
		//让表格出横向滚动条 ，此时 表头和 表中数据将分为两个部分
		"sScrollX":true,
		// 让表格的宽度不自适应 ，固定宽度。 如果不设置 表头和表中数据会分离
		//表中的数据自适应 ，表头的宽度固定
		"bAutoWidth":false,
		"oLanguage": { //国际化配置
			"sProcessing": "正在获取数据，请稍后...",
			"sLengthMenu": "显示 _MENU_ 条",
			"sZeroRecords": "查询不到相关数据",
			"sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
			"sInfoEmpty": "记录数为0",
			"sInfoFiltered": "(全部记录数 _MAX_ 条)",
			"sInfoPostFix": "",
			"sSearch": "搜索",
			"sUrl": "",
			"oPaginate": {
				"sFirst": "第一页",
				"sPrevious": "上一页",
				"sNext": "下一页",
				"sLast": "最后一页"
			}},

	});

	var table3=$('#mainContent3').DataTable({
		"deferRender": true,
		"processing": true,
		"bDestroy": true,
		"iDisplayLength": 10,
		"searching": true,
		"lengthChange": false,
		"oLanguage": {
			"sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"order": [[0, 'asc']],
		"columns": [
			{ "data": "id"},
			{ "data": "pianchano"},
			{ "data": "pianchaname"},
			{ "data": "Materialdeviation1"},
			{ "data": "Materialdeviation2"},
			{ "data": "Materialdeviation3"},
			{ "data": "Materialdeviation4"},
			{ "data": "Materialdeviation5"},
			{ "data": "Materialdeviation6"},
			{ "data": "Boneflourdeviation"},
			{ "data": "pitchdeviation"},
			{ "data": "pdTempOffset"},
			{ "data": "arriveTempOffset"},
			{ "data": "drymixingtimedeviation"},
			{ "data": "wetmixingtimedeviation"},
			{ "data": "pass475"},
			{ "data": "pass236"},
			{ "data": "pass0075"},
		],
		"columnDefs": [
			{
				"class": "tcenter",
				"targets": 0,
				"searchable": true,
				"render": function(data, type, full) {
					var xiugai='<i class="glyphicon glyphicon-random" style="font-size:13px;cursor:pointer;" data-id="'+data+'"   onclick="linkPianCha(this)" title="关联" data-toggle="modal"></i>'
					return xiugai;
				}
			}
		],
		//让表格出横向滚动条 ，此时 表头和 表中数据将分为两个部分
		"sScrollX":true,
		// 让表格的宽度不自适应 ，固定宽度。 如果不设置 表头和表中数据会分离
		//表中的数据自适应 ，表头的宽度固定
		"bAutoWidth":false,
		"oLanguage": { //国际化配置
			"sProcessing": "正在获取数据，请稍后...",
			"sLengthMenu": "显示 _MENU_ 条",
			"sZeroRecords": "查询不到相关数据",
			"sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
			"sInfoEmpty": "记录数为0",
			"sInfoFiltered": "(全部记录数 _MAX_ 条)",
			"sInfoPostFix": "",
			"sSearch": "搜索",
			"sUrl": "",
			"oPaginate": {
				"sFirst": "第一页",
				"sPrevious": "上一页",
				"sNext": "下一页",
				"sLast": "最后一页"
			}},

	});

	function initTableQuanxian(){
		$.ajax({
			type:"post",
			url:"/login/getUser",
			async:false,
			data:{
			},
			success:function(json){
				if(json!=null &&json!=""){
					var arr = json.uPermissions.split(',');
					for(var i=0;i<arr.length;i++){
						var arr2 = arr[i].replace("+","");
						if(arr[i].indexOf("Pbed") >= 0 ){
							$(".Pbed").show();
						}
						if(arr[i].indexOf("Pbeb") >= 0 ){
							$(".Pbeb").show();
						}
						if(arr[i].indexOf("Pbec") >= 0 ){
							$(".Pbec").show();
						}
						if(arr[i].indexOf("Pbef") >= 0 ){
							$(".Pbef").show();
						}
						if(arr[i].indexOf("Pbeg") >= 0 ){
							$(".Pbeg").show();
						}
					}

				}

			}
		});
	}

	//全局正则KV集合
	var regMap = {
		lnglat: "^\\d+(\\.\\d+)?$",
		price: "^\\d+(\\.\\d+)?$",
		xiaoshu: "^\\d+(\\.\\d+)?$",
	}
	//全局错误提示
	var errMsg = {
		radio: '油石比输入错误，请输入纯数字',
		lnglat: '请输入小数精确至6位的标准经纬度',
		pdtemp: '成品温度要求输入错误，请输入纯数字',
		arrivetemp: '到现场温度要求输入错误，请输入纯数字',
		price: '单价输入错误，请输入纯数字',
		pdneed: '成品需要量输入错误，请输入纯数字',

		Materialdeviation1: '0-3偏差量输入错误，请输入纯数字',
		Materialdeviation2: '3-6偏差量输入错误，请输入纯数字',
		Materialdeviation3: '6-11偏差量输入错误，请输入纯数字',
		Materialdeviation4: '11-17偏差量输入错误，请输入纯数字',
		Materialdeviation5: '17-22偏差量输入错误，请输入纯数字',
		Materialdeviation6:'22-32偏差量输入错误，请输入纯数字',

		Boneflourdeviation:'粉料偏差量输入错误，请输入纯数字',
		pitchdeviation:'沥青偏差量输入错误，请输入纯数字',
		pdTempOffset:'最高温度输入错误，请输入纯数字',
		arriveTempOffset:'最低温度输入错误，请输入纯数字',
		drymixingtimedeviation:'干拌时间偏差输入错误，请输入纯数字',
		wetmixingtimedeviation:'成品需要量输入错误，请输入纯数字',
		pass475:'成品需要量输入错误，请输入纯数字',
		pass236:'成品需要量输入错误，请输入纯数字',
		pass0075:'成品需要量输入错误，请输入纯数字',
	}
	//新建生产计划
	var app5 = new Vue({
		el: '#NewShengChanJiHua',
		//表单数据
		data: {
			planno:"",
			roadid:"",
			/* roadnumber:"", */
			//成品需要量
			pdneed:"",
			finishTime:"",
			drymixingtime:"",
			wetmixingtime:"",
			//油石比
			radio:"",
			//成品温度要求
			pdtemp:"",
			//到现场温度要求
			arrivetemp: "",
			//单价
			price: "",
			// 配方编号
			recipeid: "",
			roadList: '',
			roadSelected: '',
			recipeList: '',
			recipeSelected: '',
			distance: '',
			pathPlan: '',
			lng: '',
			lat: '',
			stakeMark: '',
			turnRoundStakeMark: '',
			team: '',
			shigongceng: '',
			chedao: '',
			direction: '',
			roadName: '',
		},
		methods: {
			//新建生产计划保存按钮事件
			save: function () {
				// if(this.planno==""){
				// 	toastr.error("生产计划编号为空!")
				// 	return;
				// }
				if (this.roadName == "") {
					toastr.error("路名为空!")
					return;
				}
				if (this.finishTime == "") {
					toastr.error("要求完成时间为空!")
					return;
				}
				if (this.pdneed == "") {
					toastr.error("成品需要量为空!")
					return;
				}if(this.pdtemp==""){
					toastr.error("成品温度要求为空!")
					return;
				}if(this.stakeMark==""){
					toastr.error("施工桩号为空!")
					return;
				}if(this.team==""){
					toastr.error("路名施工队为空!")
					return;
				}
				if(this.drymixingtime=="")this.drymixingtime="00:00:00";
				if(this.wetmixingtime=="")this.wetmixingtime="00:00:00";
				if(this.distance=="")this.distance="0";
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/ShengChanJiHua/addShengChanJiHua',JSON.stringify(this._data),{}).then((res) => {
					var resMsg = res.body;
					if (resMsg.daoMsg > 0) {
						/* $('#mainContent').DataTable().row.add(resMsg.obj).draw(); */
						$("#myModal2").modal("hide");
						initTable();
						toastr.success(resMsg.resultMsg);
						var conflictMsgArr=resMsg.conflictMsg;
						if(conflictMsgArr!=null&&conflictMsgArr.size!=0){
							for(var i=0;i<conflictMsgArr.length;i++){
								arr.push(conflictMsgArr[i].planno)
								toastr.error("完成时间与"+conflictMsgArr[i].finishTime+"的"+conflictMsgArr[i].roadname+"路段冲突");
							}
						}

					}else {
						toastr.error(resMsg.resultMsg);
					}
				}, (res) => {

				});
			},
			reg:function(value,regType,id) {
				var re = new RegExp(regMap[regType]);
				var flag;
				flag = reg(value, re);
				if (null != value && '' != value) {
					if (!flag) {
						app5[id] = "";
						toastr.error(errMsg[id]);
					}
				}
			},
			roadPost:function(){
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/SysRoadMgnController/getAllSysRoadMgnLowcase',{},{emulateJSON:true}).then((res) => {
					this.roadList = res.body;
					this.roadSelected = app5.roadList[0].roadid;
				}, (res) => {
					console.log(res.status);
				});
			},
			recipePost:function(){

				this.$http.post('/SysFormulationManagement/selectAllSysFormulationManagement',{'roadid':this.roadSelected},{emulateJSON:true}).then((res) => {
					this.recipeList = res.body;
					this.recipeSelected = this.recipeList[0].flId;
				}, (res) => {
					console.log(res.status);
				});
			}
		}
	})
	//初始化下拉框路段
	app5.roadPost();
	app5.recipePost();

	function udMsg(obj){
		var tr=$(obj).parents("tr");
		var data=$("#mainContent").DataTable().row(tr).data();
		xgSCVm.planid = data.planid;
		xgSCVm.planno = data.planno;
		xgSCVm.roadid = data.roadid;
		xgSCVm.pdneed = data.pdneed;
		xgSCVm.datetime = data.datetime;
		xgSCVm.drymixingtime = data.drymixingtime;
		xgSCVm.wetmixingtime = data.wetmixingtime;
		xgSCVm.radio = data.radio;
		xgSCVm.pdtemp = data.pdtemp;
		xgSCVm.arrivetemp = data.arrivetemp;
		xgSCVm.price = data.price;
		xgSCVm.recipeid = data.recipeid;
		xgSCVm.price = data.price;
		xgSCVm.roadSelected = data.roadid;
		xgSCVm.recipeSelected = data.recipeid;
		xgSCVm.distance = data.distance;
		xgSCVm.pathPlan = data.pathPlan;
		xgSCVm.lng = data.lng;
		xgSCVm.lat = data.lat;
		xgSCVm.stakeMark = data.stakeMark;
		xgSCVm.turnRoundStakeMark = data.turnRoundStakeMark;
		xgSCVm.team = data.team;
		xgSCVm.shigongceng = data.shigongceng;
		xgSCVm.chedao = data.chedao;
		xgSCVm.direction = data.direction;
		xgSCVm.roadName = data.roadname;
		xgSCVm.finishTime = data.finishTime;
		xgSCVm.siteId = data.siteId;
		console.log(data);
	}
	function pcMsg(obj){
		var tr=$(obj).parents("tr");
		var data=$("#mainContent2").DataTable().row(tr).data();
		xgSGPC.id=data.id;
		xgSGPC.pianchano=data.pianchano;
		xgSGPC.pianchaname=data.pianchaname;
		xgSGPC.Materialdeviation1=data.Materialdeviation1;
		xgSGPC.Materialdeviation2=data.Materialdeviation2;
		xgSGPC.Materialdeviation3=data.Materialdeviation3;
		xgSGPC.Materialdeviation4=data.Materialdeviation4;
		xgSGPC.Materialdeviation5=data.Materialdeviation5;
		xgSGPC.Materialdeviation6=data.Materialdeviation6
		xgSGPC.Boneflourdeviation=data.Boneflourdeviation
		xgSGPC.pitchdeviation=data.pitchdeviation
		xgSGPC.pdTempOffset=data.pdTempOffset
		xgSGPC.arriveTempOffset=data.arriveTempOffset
		xgSGPC.drymixingtimedeviation=data.drymixingtimedeviation
		xgSGPC.wetmixingtimedeviation=data.wetmixingtimedeviation
		xgSGPC.pass475=data.pass475
		xgSGPC.pass236=data.pass236
		xgSGPC.pass0075=data.pass0075
	}

	//修改生产计划
	var xgSCVm = new Vue({
		el: '#change2',
		//表单数据
		data: {
			planid: "",
			planno: "",
			roadid: "",
			roadnumber: "",
			datetime: "",
			//成品需要量
			pdneed: 0,
			drymixingtime: "",
			wetmixingtime: "",
			//油石比
			radio: 0,
			//成品温度要求
			pdtemp: 0,
			//到现场温度要求
			arrivetemp: 0,
			//单价
			price: 0,
			// 配方编号
			recipeid: "",
			roadList: '',
			roadSelected: '',
			recipeList: '',
			recipeSelected: '',

			distance: '',
			pathPlan: '',
			lng: '',
			lat: '',
			stakeMark: '',
			turnRoundStakeMark: '',
			team: '',
			chedao: '',
			shigongceng: '',
			direction: '',
			roadName: '',
			siteId: '',
			finishTime: '',
		},
		methods: {
			//新建生产计划保存按钮事件
			save: function () {
				// if(this.planno==""){
				// 	toastr.error("生产计划编号为空!")
				// 	return;
				// }
				if (this.roadName == "") {
					toastr.error("路名为空!")
					return;
				}
				if (this.finishTime == "") {
					toastr.error("要求完成时间为空!")
					return;
				}
				if (this.pdneed == "") {
					toastr.error("成品需要量为空!")
					return;
				}if(this.pdtemp==""){
					toastr.error("成品温度要求为空!")
					return;
				}if(this.stakeMark==""){
					toastr.error("施工桩号为空!")
					return;
				}if(this.team==""){
					toastr.error("路名施工队为空!")
					return;
				}
				if(this.drymixingtime=="")this.drymixingtime="00:00:00";
				if(this.wetmixingtime=="")this.wetmixingtime="00:00:00";
				if(this.distance=="")this.distance="0";
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/ShengChanJiHua/updateShengChanJiHua',JSON.stringify(this._data),{}).then((res) => {
					var resMsg = res.body;
					if (resMsg.daoMsg > 0) {
						$("#change2").modal("hide");
						initTable();
						initTableQuanxian()
						toastr.success(resMsg.resultMsg);
						var conflictMsgArr=resMsg.conflictMsg;
						if(conflictMsgArr!=null&&conflictMsgArr.size!=0){
							for(var i=0;i<conflictMsgArr.length;i++){
								arr.push(conflictMsgArr[i].planno)
								toastr.error("完成时间与"+conflictMsgArr[i].finishTime+"的"+conflictMsgArr[i].roadname+"路段冲突");
							}
						}
					}else {
						toastr.error(resMsg.resultMsg);
					}
				}, (res) => {

				});
			},
			reg:function(value,regType,id) {
				var re = new RegExp(regMap[regType]);
				var flag;
				flag = reg(value, re);
				if (null != value && '' != value) {
					if (!flag) {
						this._data[id] = "";
						toastr.error(errMsg[id]);
					}
				}
			},
			roadPost:function(){
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/SysRoadMgnController/getAllSysRoadMgnLowcase',{},{emulateJSON:true}).then((res) => {
					this.roadList = res.body;
					this.roadSelected = xgSCVm.roadList[0].roadid;
				}, (res) => {
					console.log(res.status);
				});
			},
			recipePost:function(){

				this.$http.post('/SysFormulationManagement/selectAllSysFormulationManagement',{'roadid':this.roadSelected},{emulateJSON:true}).then((res) => {
					this.recipeList = res.body;
					this.recipeId = this.recipeSelected;
				}, (res) => {
					console.log(res.status);
				});
			}
		}
	})

	//初始化下拉框路段
	xgSCVm.roadPost();
	xgSCVm.recipePost();


	var arr=[];
	var colorArr=[];
	function initTable(){
		$.ajax({
			type: 'POST',
			url: '/ShengChanJiHua/getAllShengChanJiHua',
			dataType: 'json',
			data: {
			},
			error: function (msg) {
				errMessage("请求UserController失败");
			},
			success: function (json) {

				/* initTbVm(); */

				/*for(var i=0;i<json.length-1;i++){
					var time1=json[i].finishTime.split(" ");
					var time2=json[i+1].finishTime.split(" ");

					if(time1[0]==time2[0]&&time2[1]!=undefined&&time1[1]!=undefined){
						var xctime=timeDifference(time2[1],time1[1])
						//console.log("时间差==="+xctime);
						if(Math.abs(xctime)<30){
							var no=json[i].planno+"-"+json[i+1].planno;
							arr.push(no)
							colorArr.push(getRandomColor())
						}
					}
				}*/
				for(var i=0;i<json.length;i++){
					for(var j=i;j<json.length;j++){
						if(i!=j){
							var time1=json[i].finishTime.split(" ");
							var time2=json[j].finishTime.split(" ");
							if(time1[0]==time2[0]&&time2[1]!=undefined&&time1[1]!=undefined){
								var xctime=timeDifference(time2[1],time1[1])
								console.log("时间差==="+xctime);
								if(Math.abs(xctime)<30){
									var no=json[i].planno+"-"+json[j].planno;
									arr.push(no)
									var color=getRandomColor()
									colorArr.push(color)

								}
							}
						}
					}
				}

				$("#mainContent").dataTable().fnClearTable();
				$("#mainContent").DataTable().rows.add(json).draw(false);

			}
		});
	}

	function getRandomColor() {
		var color= '#' +
				(function(color) {
					return(color += '0123456789abcdef' [Math.floor(Math.random() * 16)]) &&
					(color.length == 6) ? color : arguments.callee(color);
				})('');
		if(colorArr.indexOf(color) >= 0 ) {
			//'colorArr中包含color字符串';
			getRandomColor()
		}
		return color;
	}

	function timeDifference(startTime,endTime){
		var start1=startTime.split(":");
		var startAll=parseInt(start1[0]*60)+parseInt(start1[1]);
		var end1=endTime.split(":");
		var endAll=parseInt(end1[0]*60)+parseInt(end1[1]);
		var xiangchatime=endAll-startAll;
		return xiangchatime
	}

	function initTablePianCha(){
		$.ajax({
			type: 'POST',
			url: '/ShengChanJiHua/getAllShiGongPianCha',
			dataType: 'json',
			data: {
			},
			error: function (msg) {
				errMessage("请求UserController失败");
			},
			success: function (json) {
				$("#mainContent2").dataTable().fnClearTable();
				$("#mainContent2").DataTable().rows.add(json).draw(false);
				$("#mainContent3").dataTable().fnClearTable();
				$("#mainContent3").DataTable().rows.add(json).draw(false);
				/* initTbVm(); */
			}
		});
	}

	function reg(str,re){
		if (re.test(str)) {
			return true;
		} else {
			return false;
		}
	}
	//箭头函数，内部this永远指向父级
	var delMsg = (e)=>{
		var tr = $(e).parents("tr");
		var msg = "确定要删除吗？\n\n请确认！";
		if (confirm(msg) == true) {
			$.ajax({
				type: 'POST',
				url: '/ShengChanJiHua/delShengChanJiHuaById',
				dataType: 'json',
				data: {
					planid:$(e).attr("data-id")
				},
				error: function (msg) {
					errMessage("请求UserController失败");
				},
				success: function (json) {
					if(json>0){
						toastr.success("删除成功");
						$('#mainContent').DataTable().row(tr).remove().draw(false); //删除行立即显示
					}else{
						toastr.error("删除失败");
					}
				}
			});
		}else{
			return false;
		}
		console.log(msg);
	}


	//箭头函数，内部this永远指向父级
	var delpiancha = (e)=>{
		var tr = $(e).parents("tr");
		var msg = "确定要删除吗？\n\n请确认！";
		if (confirm(msg) == true) {
			$.ajax({
				type: 'POST',
				url: '/ShengChanJiHua/delShiGongPianChaById',
				dataType: 'json',
				data: {
					id:$(e).attr("data-id")
				},
				error: function (msg) {
					errMessage("请求UserController失败");
				},
				success: function (json) {
					if(json>0){
						toastr.success("删除成功");
						$('#mainContent2').DataTable().row(tr).remove().draw(false); //删除行立即显示
					}else{
						toastr.error("删除失败");
					}
				}
			});
		}else{
			return false;
		}
		console.log(msg);
	}


	//新建施工偏差
	var addSGPC = new Vue({
		el: '#addSGPC',
		//表单数据
		data: {
			pianchano:"",
			pianchaname:"",
			Materialdeviation1:"",
			Materialdeviation2:"",
			Materialdeviation3:"",
			Materialdeviation4:"",
			Materialdeviation5:"",
			Materialdeviation6:"",
			//粉料偏差量
			Boneflourdeviation:"",
			//沥青偏差量
			pitchdeviation:"",
			pdTempOffset:"",
			arriveTempOffset:"",
			//干拌
			drymixingtimedeviation:'',
			//湿拌
			wetmixingtimedeviation:'',
			pass475:'',
			pass236:'',
			pass0075:'',
		},
		methods: {
			//新建生产计划保存按钮事件
			save: function () {
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/ShengChanJiHua/addShiGongPianCha',JSON.stringify(this._data),{}).then((res) => {
					var resMsg = res.body;
					if (resMsg.daoMsg > 0) {
						/* $('#mainContent').DataTable().row.add(resMsg.obj).draw(); */
						$("#myModal3").modal("hide");
						initTablePianCha();
						toastr.success(resMsg.resultMsg);
					} else {
						toastr.error(resMsg.resultMsg);
					}
				}, (res) => {

				});
			},
			reg:function(value,regType,id) {
				var re = new RegExp(regMap[regType]);
				var flag;
				flag = reg(value, re);
				if (null != value && '' != value) {
					if (!flag) {
						addSGPC[id] = "";
						toastr.error(errMsg[id]);
					}
				}
			}
		}
	})

	//修改施工偏差
	var xgSGPC = new Vue({
		el: '#xgSGPC',
		//表单数据
		data: {
			id:"",
			pianchano:"",
			pianchaname:"",
			Materialdeviation1:"",
			Materialdeviation2:"",
			Materialdeviation3:"",
			Materialdeviation4:"",
			Materialdeviation5:"",
			Materialdeviation6:"",
			//粉料偏差量
			Boneflourdeviation:"",
			//沥青偏差量
			pitchdeviation:"",
			pdTempOffset:"",
			arriveTempOffset:"",
			//干拌
			drymixingtimedeviation:'',
			//湿拌
			wetmixingtimedeviation:'',
			pass475:'',
			pass236:'',
			pass0075:'',
		},
		methods: {
			//新建生产计划保存按钮事件
			save: function () {
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/ShengChanJiHua/updateShiGongPianCha',JSON.stringify(this._data),{}).then((res) => {
					var resMsg = res.body;
					if (resMsg.daoMsg > 0) {
						/* $('#mainContent').DataTable().row.add(resMsg.obj).draw(); */
						$("#change3").modal("hide");
						initTablePianCha();
						initTableQuanxian()
						toastr.success(resMsg.resultMsg);
					} else {
						toastr.error(resMsg.resultMsg);
					}
				}, (res) => {

				});
			},
			reg:function(value,regType,id) {
				var re = new RegExp(regMap[regType]);
				var flag;
				flag = reg(value, re);
				if (null != value && '' != value) {
					if (!flag) {
						xgSGPC[id] = "";
						toastr.error(errMsg[id]);
					}
				}
			},
			recipePost:function(){

				this.$http.post('/SysFormulationManagement/selectAllSysFormulationManagement',{'roadid':this.roadSelected},{emulateJSON:true}).then((res) => {
					this.recipeList = res.body;
					this.recipeSelected = this.recipeList[0].flId;
				}, (res) => {
					console.log(res.status);
				});
			}
		}
	})

	var linkPianChaDetailVm = new Vue({
		el: '#linkPianChaDetailVm',
		//表单数据
		data: {
			id:"",
			pianchano:"",
			pianchaname:"",
			Materialdeviation1:"",
			Materialdeviation2:"",
			Materialdeviation3:"",
			Materialdeviation4:"",
			Materialdeviation5:"",
			Materialdeviation6:"",
			//粉料偏差量
			Boneflourdeviation:"",
			//沥青偏差量
			pitchdeviation:"",
			pdTempOffset:"",
			arriveTempOffset:"",
			//干拌
			drymixingtimedeviation:'',
			//湿拌
			wetmixingtimedeviation:'',
			pass475:'',
			pass236:'',
			pass0075:'',
		},
		methods: {
		}
	})


	//修改施工偏差
	var glpianchaVm = new Vue({
		el: '#glpianchaVm',
		//表单数据
		data: {
			planid:"",
			pianchaid:"",
			pianchaname:"",
		},
		methods: {
			//新建生产计划保存按钮事件
			save: function (msg) {
				var param = {
					planid:this.planid,
					pianchaid:this.pianchaid
				};
				//发送 post 请求  then中第一个function或者箭头函数为success回调函数, 第二个function为失败fail回调函数
				this.$http.post('/ShengChanJiHua/linkShiGongPianCha',param,{emulateJSON:true}).then((res) => {

					var resMsg = res.body;
					if (resMsg > 0) {
						glpianchaVm.pianchaname = msg;
						toastr.success("关联成功");
					} else {
						toastr.error("关联失败");
					}
				}, (res) => {

				});
			},
		}
	})


	laydate.render({
		elem: '#drymixingtime', //指定元素
		type: 'time',
		done: function(value, date){
			app5.drymixingtime=value;
		}
	});
	laydate.render({
		elem: '#xgwetmixingtime', //指定元素
		type: 'time',
		done: function(value, date){
			xgSCVm.wetmixingtime=value;
		}
	});

	laydate.render({
		elem: '#finishTime', //指定元素
		type: 'datetime',
		done: function(value, date){
			app5.finishTime=value;
		}
	});

	laydate.render({
		elem: '#xgfinishTime', //指定元素
		type: 'datetime',
		done: function(value, date){
			xgSCVm.finishTime=value;
		}
	});

	laydate.render({
		elem: '#wetmixingtime', //指定元素
		type: 'time',
		done: function(value, date){
			app5.wetmixingtime=value;
		}
	});
	laydate.render({
		elem: '#xgdrymixingtime', //指定元素
		type: 'time',
		done: function(value, date){
			app5.drymixingtime=value;
		}
	});
	laydate.render({
		elem: '#drymixingtimedeviation', //指定元素
		type: 'time',
		done: function(value, date){
			addSGPC.drymixingtimedeviation=value;
		}
	});

	laydate.render({
		elem: '#wetmixingtimedeviation', //指定元素
		type: 'time',
		done: function(value, date){
			addSGPC.wetmixingtimedeviation=value;
		}
	});
	laydate.render({
		elem: '#xgdrymixingtimedeviation', //指定元素
		type: 'time',
		done: function(value, date){
			xgSGPC.drymixingtimedeviation=value;
		}
	});

	laydate.render({
		elem: '#xgwetmixingtimedeviation', //指定元素
		type: 'time',
		done: function(value, date){
			xgSGPC.wetmixingtimedeviation=value;
		}
	});

	var isNull = (e) =>{
		if(e!=''&&e!=null&&e!=undefined)
			return false;
		return true;
	}

	var linkPianCha = (e)=>{
		var tr=$(e).parents("tr");
		var data=$("#mainContent3").DataTable().row(tr).data();
		var msg = "确定要关联该偏差吗？\n\n请确认！";
		if (confirm(msg) == true) {
			glpianchaVm.pianchaid=data.id;
			glpianchaVm.save(data.pianchaname);
		}else{
			return false;
		}
	}

	var linkMsg = (e)=>{
		var tr=$(e).parents("tr");
		var data=$("#mainContent").DataTable().row(tr).data();
		glpianchaVm.planid = data.planid;
		if(!isNull(data.pianchaid)){
			glpianchaVm.pianchaname = data.pianchaname;
		}else{
			glpianchaVm.pianchaname ="";
		}
	}


	var lookPianChaMsg = (e)=>{
		$.ajax({
			type: 'POST',
			url: '/ShengChanJiHua/getPianChaById',
			dataType: 'json',
			data: {
				id:$(e).attr("data-id")
			},
			error: function (msg) {
				errMessage("请求UserController失败");
			},
			success: function (json) {
				bindLinkPianCha(json);
			}
		});
	}

	var bindLinkPianCha = (data) =>{
		linkPianChaDetailVm.id=data.id;
		linkPianChaDetailVm.pianchano=data.pianchano;
		linkPianChaDetailVm.pianchaname=data.pianchaname;
		linkPianChaDetailVm.Materialdeviation1=data.Materialdeviation1;
		linkPianChaDetailVm.Materialdeviation2=data.Materialdeviation2;
		linkPianChaDetailVm.Materialdeviation3=data.Materialdeviation3;
		linkPianChaDetailVm.Materialdeviation4=data.Materialdeviation4;
		linkPianChaDetailVm.Materialdeviation5=data.Materialdeviation5;
		linkPianChaDetailVm.Materialdeviation6=data.Materialdeviation6
        linkPianChaDetailVm.Boneflourdeviation = data.Boneflourdeviation
        linkPianChaDetailVm.pitchdeviation = data.pitchdeviation
        linkPianChaDetailVm.pdTempOffset = data.pdTempOffset
        linkPianChaDetailVm.arriveTempOffset = data.arriveTempOffset
        linkPianChaDetailVm.drymixingtimedeviation = data.drymixingtimedeviation
        linkPianChaDetailVm.wetmixingtimedeviation = data.wetmixingtimedeviation
        linkPianChaDetailVm.pass475 = data.pass475
        linkPianChaDetailVm.pass236 = data.pass236
        linkPianChaDetailVm.pass0075 = data.pass0075
    }


    /******************************************/
    /*地图*/
    let map = new BMap.Map("map");
    map.setMinZoom(5);
    map.centerAndZoom("江苏省", 8);
    map.enableScrollWheelZoom(true);
    map.addEventListener("click", function (e) {
        map.clearOverlays();
        app5.lng = e.point.lng;
        app5.lat = e.point.lat;
        let marker = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat));
        map.addOverlay(marker);
    });

    /******************************************/
	/******************************************/
	/*地图*/
	let xgmap = new BMap.Map("xgmap");
	xgmap.setMinZoom(5);
	xgmap.centerAndZoom("江苏省", 8);
	xgmap.enableScrollWheelZoom(true);
	xgmap.addEventListener("click", function (e) {
		xgmap.clearOverlays();
		xgSCVm.lng = e.point.lng;
		xgSCVm.lat = e.point.lat;
		let marker = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat));
		xgmap.addOverlay(marker);
	});

	/******************************************/
</script>
</html>