<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>首页</title>
		<link rel="stylesheet" type="text/css" href="../css/bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="../css/bootstrap-theme.css" />
		<link rel="stylesheet" type="text/css" href="../css/layui.css" />
		<!--<link rel="stylesheet" type="text/css" href="../css/index.css" />-->
		<style>
			.main-table tr td {
				padding: 3px;
			}
			
			.main-table .red {
				color: red;
			}
			
			.layui-tab-title .layui-this {
				background-color: #2D70BE;
			}
			
			.layui-this {
				border: 0px solid #dedede !important;
				
			}
			
			.layui-tab-title li {
				border: 1px solid #3574C1;
				border-radius: 50%;
				height: 15px;
				width: 15px;
				min-width: 5px;
				padding: 0px;
				margin-right: 100px;
				background-color: white;
			}
			
			.layui-tab-title {
				border: 0px solid #dedede !important;
			}
			
			.layui-tab-item {
				margin-left: -30px !important;
			}
			.layui-tab-title li{
			   color:#397EEB;
			    padding-top:5px;
			    padding-left:-30px;
			}
			.layui-this{
			   color:#397EEB !important;
			   font-weight:bolder;
			    padding-top:5px;
			    padding-left:-30px;
			}
			@media screen and (min-width: 1920px) {
				.righttop {
					margin-top: -20% !important;
				}
				.rightbottom {
					top: 200px !important;
				}
				.rightbottom span {
					margin-top: 1% !important;
				}
			}
		</style>
	</head>

	<body class="jd" style="background-color: #F5F5F5;">
		<div class="head" style="height: 100%;width: 100%;"></div>
		<div class="layui-tab" style="position: absolute;margin-left: 3%;height:10px;padding-left:200px;border-radius: 5px;bottom:7%">
			<div style="height:5px;width:58%;position:absolute;margin-top:5px;"></div>
			<!-- <ul class="layui-tab-title" style="height: 10px !important;">
				<li class="layui-this">沪宁高速</li>
				<li>沪深高速</li>
				<li>港澳高速</li>
				<li>宁粤高速</li>
				<li>宁粤高速</li>
				<li>沿江高速</li>
			</ul> -->
			<div class="layui-tab-content">
				<div class="layui-tab-item layui-show">
						<div id="main" style="height:800px;width:800px;margin:0 15px;float:left;margin-top: -100%;margin-left:-20%"></div>
					</div>
					 <div id="box" >
	            <span id="box-title"></span>
	        </div>
				<!-- <div class="layui-tab-item">
				        <div id="main1" style="height:800px;width:800px;margin:0 15px;float:left;margin-top: -105%;margin-left:-20%"></div>
				</div>
				<div class="layui-tab-item">
				         <div id="main2" style="height:800px;width:800px;margin:0 15px;float:left;margin-top: -105%;margin-left:-20%"></div>
				</div>
				<div class="layui-tab-item">
				         <div id="main3" style="height:800px;width:800px;margin:0 15px;float:left;margin-top: -105%;margin-left:-20%"></div>
				</div>
				<div class="layui-tab-item">
				          <div id="main4" style="height:800px;width:800px;margin:0 15px;float:left;margin-top: -105%;margin-left:-20%"></div>
				</div>
				<div class="layui-tab-item">
				          <div id="main5" style="height:800px;width:800px;margin:0 15px;float:left;margin-top: -105%;margin-left:-20%"></div>
				</div> -->
			</div>
		</div>
		<div class="y-span10 y-last">
			<div class="B" style="float: right;">
				<div class="rightfirst col-xs-4" style="float: right;background-color: white;margin-right: 0px;height: 290px;width: 580px;">
					<div class="title2" style="margin-left: 1%;padding-top: 2%;">
						<img src="../images/dec.png" />
						<p style="display: inline-block;color: #1897e8;font-size: 15px;font-weight: bold;margin-left: 1%;">施工桩号供需统计</p>
					</div>
					<!--标题结束-->
					<div id="chart1" style="width:550px; height: 250px;"></div>
				</div>
				<div class="rightsec col-xs-4" style="float: right;background-color: white;margin-right: 2%;height: 290px;width: 580px;position: absolute;margin-top: 18%;">
					<div class="title3" style="margin-left: 1%;padding-top: 2%;">
						<img src="../images/dec.png" />
						<p style="display: inline-block;color: #1897e8;font-size: 15px;font-weight: bold;margin-left: 1%;">日生产量统计</p>
					</div>
					<!--标题结束-->
					<div id="chart2" style="width:550px; height: 280px;"></div>
				</div>
				<div class="rightsec col-xs-4" style="float: right;background-color: white;margin-right: 2%;height: 290px;width: 580px;position: absolute;margin-top: 36%;">
					<div class="title3" style="margin-left: 1%;padding-top: 2%;">
						<img src="../images/dec.png" />
						<p style="display: inline-block;color: #1897e8;font-size: 15px;font-weight: bold;margin-left: 1%;">成本及进度管理统计</p>
						<!--<input type="date" name="" id="" value="" / style="float: right;height: 25px;">-->
					</div>
					<!--标题结束-->
					<div id="chart3" style="width:550px; height: 280px;"></div>
				</div>
			</div>
			<div class="table" style="background-color: #FFF;width: 60%;height: 950px;margin-left: 1%;margin-top: 1%;">

				<div class="bj_nav y-clearfix">
					<div class="title" style="margin-left: 1%;padding-top: 1%;">
						<img src="../images/dec.png" />
						<p style="display: inline-block;color: #1897e8;font-size: 15px;font-weight: bold;margin-left: 1%;">线路走势图</p>
					</div>
					
				</div>
				<!-- <div class="jt" style="margin-top: 845px;">
					<a href="" style="display: inline-block;position: absolute;left: 100px;"><img src="../images/icon_left2.png" /></a>
					<a href="" style="display: inline-block;position: absolute;left: 100px;margin-left: 800px;"><img src="../images/icon_right1.png" /></a>
				</div> -->

			</div>

		</div>
		</div>
		<!-- 左边结束 -->
	</body>
	<script src="../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/echarts.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/layui.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/element.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/build/dist/echarts.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/homeEchars.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		$(document).ready(function () {
			getEcahrsData()
			getEcahrsData2()
			getEcahrsData3()
			initPoint()
		});


		let page_point;
		let page_pointArray;

		function initPoint() {
			$.ajax({
				type: 'POST',
				url: '/TanPuDiDianGuanLi/getAllTanPuDiDianVoByState',
				dataType: 'json',
				data: {
					state: 1
				},
				async: false,
				error: function (msg) {
					errMessage("请求UserController失败");
				},
				success: function (json) {

					let pointArray = [];
					let array = {};
					for (var i in json) {
						let lngLat = [];
						lngLat[0] = json[i].lng;
						lngLat[1] = json[i].lat;
						array[json[i].stakemark] = lngLat;
						// var point = new BMap.Point(json[i].lng, json[i].lat);
						// addMarker(point, json[i].stakemark, json[i].lane, json[i]);
						let point = {};
						point.name = json[i].stakemark;
						point.value = "";
						pointArray.push(point);
					}
					page_pointArray = pointArray
					page_point = array;
				}
			});
		}

		require.config({
			paths: {
				echarts: '../js/build/dist'
			}
		});

		// 使用
		require(
				[
				'echarts',
				'echarts/chart/map'
			],
			function(ec) {
				require('echarts/util/mapData/params').params.jiangsu = {

					getGeoJson: function(callback) {
						$.getJSON('../geoJson/jiangsu.json', function(data) {
							// 压缩后的地图数据必须使用 decode 函数转换
							callback(require('echarts/util/mapData/params').decode(data));
						});
					}
				}
				var myChart = ec.init(document.getElementById('main'));
				var ecConfig = require('echarts/config');
				var zrEvent = require('zrender/tool/event');
				var curIndx = 0;
				var mapType = ["江苏	"];

				myChart.on(ecConfig.EVENT.MAP_SELECTED, function(param) {});
				option = {
						 tooltip: {
		                      trigger: 'axis',
		                      axisPointer: {
		                          type: 'shadow'
		                      }
		                  },
					legend: {
						orient: 'vertical',
						x: '',
						data: [' ']
					},
					series: [{
						name: '',
						type: 'map',
						mapType: 'jiangsu',
						roam: false,
						/* selectedMode: false, */
						label: {
				              normal: {
				                show: true,
				                textStyle: {
				                  color: 'red'
				                }
				              },
				            },
						itemStyle: {
							normal: {	
								color: '#2e70bc', //地图背景色
								label: {
									show: true
								},
								borderColor: '#82E1FF',
								borderWidth: 1
							},
							
							emphasis: {
								label: {
									show: true,
									normal: {}
								}
							}
						},
						
						data: [],
						geoCoord: page_point,
						markPoint: {
							/* symbol: 'circle', */

							itemStyle: {
								normal: {
									color: '#7FE0FF'
								}
							},

							data: page_pointArray
							// [
							// 	{
							// 	name: 'A',
							// 	value: 95
							// },
							// {
							// 	name: 'B',
							// 	value: 2
							// },
							// {
							// 	name: 'C',
							// 	value: 59
							// }
							// ]
						}

					}]
				}
				myChart.setOption(option,true);
				myChart.on('click', function(params) {
					// alert(1);
					// console.log(params);//此处写点击事件内容
				});
			}
		);

		//注意：选项卡 依赖 element 模块，否则无法进行功能性操作
		layui.use('element', function() {
			var element = layui.element;

			//…
		});

		function getEcahrsData(){
			$.ajax({
				type: 'POST',
				url: '/SysRoadMgnController/getAllSysRoadMgnVoHomePage',
				dataType: 'json',
				data: {
					state: 1
				},
				error: function (msg) {
					errMessage("请求UserController失败");
				},
				success: function (json) {
					var xuqiu=[]
					var gongying=[]
					var roadname=[]
					if(json!=null&&json.length!=0){
						for(var i=0;i<json.length;i++) {
							xuqiu.push(json[i].allXuQiu)
							gongying.push(json[i].allGongYing)
							roadname.push(json[i].stakemark)
						}
					}
					initMychart1(xuqiu,gongying,roadname);
				}
			});
		}
		function initMychart1(xuqiu,gongying,roadname) {
			var chart = echarts.init(document.getElementById('chart1'));
			// 使用刚指定的配置项和数据显示图表。
			let option = setHomeLDGXTJ(xuqiu,gongying,roadname);
			chart.setOption(option);
		}

		function getEcahrsData2(){
			$.ajax({
				type: 'POST',
				url: '/SysRoadMgnController/getDayWeightCount',
				dataType: 'json',
				data: {

				},
				error: function (msg) {
					errMessage("请求UserController失败");
				},
				success: function (json) {
					var dayTime=[]
					var totalWeight=[]
					if(json!=null&&json.length!=0){
						for(var i=0;i<json.length;i++){
							dayTime.push(json[i].dayTime)
							totalWeight.push(json[i].totalWeight)
						}
					}
					initMychart2(dayTime,totalWeight);
				}
			});
		}

		function initMychart2(dayTime,totalWeight) {
			var chart = echarts.init(document.getElementById('chart2'));
			// 使用刚指定的配置项和数据显示图表。
			let option = setHomeZPZHTJ(dayTime,totalWeight);
			chart.setOption(option);
		}

		function getEcahrsData3(){
			$.ajax({
				type: 'POST',
				url: '/ChenBenJinDu/getAllChenBenJinDu',
				dataType: 'json',
				data: {

				},
				error: function (msg) {
					errMessage("请求UserController失败");
				},
				success: function (json) {

					var datetime=[]
					var chenneng=[]
					var feiliao=[]
					if(json!=null&&json.length!=0){
						for(var i=0;i<json.length;i++){
							datetime.push(json[i].datetime)
							chenneng.push(json[i].chenneng)
							feiliao.push(json[i].feiliao)
						}
					}
					initMychart3(datetime,chenneng,feiliao);
				}
			});
		}

		function initMychart3(datetime,chenneng,feiliao) {
			var chart = echarts.init(document.getElementById('chart3'));
			// 使用刚指定的配置项和数据显示图表。
			let option = setHomeCBJDTJ(datetime,chenneng,feiliao);
			chart.setOption(option);
		}

	</script>

</html>